# –ë—ä—Ä–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫: –ü—Å–∏—Ö–æ–º–µ—Ç—Ä–∏—á–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞ –ø–ª–∞–Ω–∞

> **–ö—Ä–∞—Ç–∫–æ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ** –∑–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏—Ü–∏, —Ä–∞–±–æ—Ç–µ—â–∏ —Å –ø—Å–∏—Ö–æ–º–µ—Ç—Ä–∏—á–Ω–∞—Ç–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞ `final_plan`

---

## üìã –û—Å–Ω–æ–≤–Ω–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### –¢–µ–≥–ª–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–µ—Ç–µ

```
–õ–∏—á–Ω–æ—Å—Ç–µ–Ω —Ç–µ—Å—Ç:  70%  ‚Üê –ü–æ-–æ–±–µ–∫—Ç–∏–≤–µ–Ω, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω
–í–∏–∑—É–∞–ª–µ–Ω —Ç–µ—Å—Ç:   30%  ‚Üê –ü–æ-—Å—É–±–µ–∫—Ç–∏–≤–µ–Ω, –∫–∞—á–µ—Å—Ç–≤–µ–Ω
```

### 4-–±—É–∫–≤–µ–Ω –ª–∏—á–Ω–æ—Å—Ç–µ–Ω –∫–æ–¥

```
[X/E] - [S/V] - [D/M] - [P/J]
  ‚Üì       ‚Üì       ‚Üì       ‚Üì
–ï–Ω–µ—Ä–≥–∏—è –ù–æ–≤–æ-  –ö–æ–Ω—Ç–∞–∫—Ç –°—Ç—Ä—É–∫—Ç—É—Ä–∞
        —Ç–æ—Ä—Å—Ç–≤–æ
```

**–ü—Ä–∏–º–µ—Ä**: `E-V-M-J` = –ï–∫—Å—Ç—Ä–æ–≤–µ—Ä—Ç–µ–Ω, –ù–æ–≤–∞—Ç–æ—Ä—Å–∫–∏, –ú–µ–∫, –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω

---

## üéØ 16-—Ç–µ –ª–∏—á–Ω–æ—Å—Ç–Ω–∏ —Ç–∏–ø–∞ (–∫—Ä–∞—Ç—ä–∫ –ø—Ä–µ–≥–ª–µ–¥)

### –ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç–Ω–∏ (X-...)

| –ö–æ–¥ | –¢–∏–ø | –†–∏—Å–∫ | –ö–æ–º—É–Ω–∏–∫–∞—Ü–∏—è |
|-----|-----|------|-------------|
| X-S-D-P | –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª–µ–Ω | –ü—Ä–æ–ø—É—Å–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è | –ö—Ä–∞—Ç–∫–∞, —è—Å–Ω–∞ |
| X-S-D-J | –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞–Ω | –ü—Ä–µ–∫–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–≥–æ—Å—Ç | –õ–æ–≥–∏—á–Ω–∞ |
| X-S-M-P | –ê–¥–∞–ø—Ç–∏–≤–µ–Ω | –•—Ä–∞–Ω–µ–Ω–µ –ø–æ —Å—Ä–µ–¥–∞—Ç–∞ | –ú–µ–∫–∞ |
| X-S-M-J | –¢—ä—Ä—Å–µ—â —Å–∏–≥—É—Ä–Ω–æ—Å—Ç | –°—Ç—Ä–∞—Ö –æ—Ç –ø—Ä–æ–º—è–Ω–∞ | –°–ø–æ–∫–æ–π–Ω–∞ |
| X-V-D-P | –ö—Ä–µ–∞—Ç–∏–≤–µ–Ω | –†–µ–∑–∫–∏ —Å–º–µ–Ω–∏ | –î–∏—Ä–µ–∫—Ç–Ω–∞ |
| X-V-D-J | –°—Ç—Ä–∞—Ç–µ–≥ | –ë–µ–∑ —É–¥–æ–≤–æ–ª—Å—Ç–≤–∏–µ | –†–∞–≤–Ω–æ—Å—Ç–æ–π–Ω–∞ |
| X-V-M-P | –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω | –ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ | –ü–æ–¥–∫—Ä–µ–ø—è—â–∞ |
| X-V-M-J | –î—ä–ª–±–æ–∫–æ –º–∏—Å–ª–µ—â | –°–≤—Ä—ä—Ö–æ–±–º–∏—Å–ª—è–Ω–µ | –Ø—Å–Ω–∞ |

### –ï–∫—Å—Ç—Ä–æ–≤–µ—Ä—Ç–Ω–∏ (E-...)

| –ö–æ–¥ | –¢–∏–ø | –†–∏—Å–∫ | –ö–æ–º—É–Ω–∏–∫–∞—Ü–∏—è |
|-----|-----|------|-------------|
| E-S-D-P | –î–µ–π—Å—Ç–≤–∞—â | –ë—ä—Ä–∑–æ —Ö—Ä–∞–Ω–µ–Ω–µ | –ï–Ω–µ—Ä–≥–∏—á–Ω–∞ |
| E-S-D-J | –õ–∏–¥–µ—Ä | –†–µ–∂–∏–º=–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ | –¶–µ–ª–µ–Ω–∞—Å–æ—á–µ–Ω–∞ |
| E-S-M-P | –°–æ—Ü–∏–∞–ª–µ–Ω | –•—Ä–∞–Ω–∏ —Å–µ –∑–∞ –∫–æ–º–ø–∞–Ω–∏—è | –¢–æ–ø–ª–∞ |
| E-S-M-J | –ì—Ä–∏–∂–æ–≤–µ–Ω | –î—Ä—É–≥–∏ > —Å–µ–±–µ —Å–∏ | –ü—Ä–∏–∑–Ω–∞—Ç–µ–ª–Ω–∞ |
| E-V-D-P | –ï–Ω–µ—Ä–≥–∏—á–µ–Ω | –ö—Ä–∞–π–Ω–æ—Å—Ç–∏ | –ú–æ—Ç–∏–≤–∏—Ä–∞—â–∞ |
| E-V-D-J | –í–∏–∑–∏–æ–Ω–µ—Ä | –•—Ä–∞–Ω–∞=–≥–æ—Ä–∏–≤–æ | –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞ |
| E-V-M-P | –ï–º–æ—Ü–∏–æ–Ω–∞–ª–µ–Ω | –•–∞–æ—Ç–∏—á–µ–Ω —Ä–µ–∂–∏–º | –ï–º–ø–∞—Ç–∏—á–Ω–∞ |
| E-V-M-J | –ë–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω | –ü—Ä–µ–Ω–∞—Ç–æ–≤–∞—Ä–≤–∞–Ω–µ | –ü–∞—Ä—Ç–Ω—å–æ—Ä—Å–∫–∞ |

---

## üîó –ö–æ—Ä–µ–ª–∞—Ü–∏–æ–Ω–Ω–∏ –ø–æ–ª–µ—Ç–∞

### E (–ï–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è)
```javascript
chronotype: "–°—É—Ç—Ä–µ—à–µ–Ω" ‚Üí E‚Üë
stressLevel: "–í–∏—Å–æ–∫–æ" ‚Üí E‚Üì
comparisson: "–ß–µ—Å—Ç–æ" ‚Üí E‚Üë
```

### C (–°—Ç—Ä—É–∫—Ç—É—Ä–∞)
```javascript
sleepHours: "7-8" ‚Üí C‚Üë
overeatingFrequency: "–†—è–¥–∫–æ" ‚Üí C‚Üë
nighteat: "–Ω–µ –∑–∞–∫—É—Å–≤–∞–º" ‚Üí C‚Üì
```

### N (–ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–∞ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
```javascript
stressLevel: "–í–∏—Å–æ–∫–æ" ‚Üí N‚Üë
foodTriggers: ["–ù–∞–ø—Ä–µ–∂–µ–Ω–∏–µ", "–¢—ä–≥–∞"] ‚Üí N‚Üë
overeatingFrequency: "–ß–µ—Å—Ç–æ" ‚Üí N‚Üë
```

### I (–ò–º–ø—É–ª—Å–∏–≤–Ω–æ—Å—Ç)
```javascript
overeatingFrequency: "–ß–µ—Å—Ç–æ" ‚Üí I‚Üë
foodCravings: "–î–∞" ‚Üí I‚Üë
nighteat: "—Ö–∞–ø–≤–∞ –Ω–∞ –∫—Ä–∞–∫" ‚Üí I‚Üë
```

---

## üìä Concordance Levels

```
‚â• 0.75  ‚Üí  "high"     –í–∏—Å–æ–∫–∞ —Å—ä–≥–ª–∞—Å—É–≤–∞–Ω–æ—Å—Ç ‚úÖ
‚â• 0.55  ‚Üí  "medium"   –£–º–µ—Ä–µ–Ω–∞ —Å—ä–≥–ª–∞—Å—É–≤–∞–Ω–æ—Å—Ç ‚ö†Ô∏è
< 0.55  ‚Üí  "low"      –ù–∏—Å–∫–∞ —Å—ä–≥–ª–∞—Å—É–≤–∞–Ω–æ—Å—Ç ‚ùå
```

**High**: –ü—ä–ª–Ω–æ –¥–æ–≤–µ—Ä–∏–µ –≤ –æ—Ü–µ–Ω–∫–∞—Ç–∞  
**Medium**: –í–∞–ª–∏–¥–Ω–∞, —Å –º–∞–ª–∫–∏ –Ω–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è  
**Low**: –ù—É–∂–Ω–∞ —Ä–µ–≤–∏–∑–∏—è, –≤—ä–∑–º–æ–∂–Ω–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ Composite Profile

```javascript
{
  personalityType: "X-S-D-P",       // 4-–±—É–∫–≤–µ–Ω –∫–æ–¥
  visualType: "01",                  // 01-08
  correlationScore: 0.78,            // 0-1
  concordanceLevel: "high",          // high/medium/low
  
  dimensions: { E: 45, C: 72, ... }, // 7 –∏–∑–º–µ—Ä–µ–Ω–∏—è
  
  strengths: [...],                  // 70% personality + 30% visual
  risks: [...],                      // Weighted merge
  recommendations: [...],            // Weighted merge
  
  conflicts: [],                     // –°–∞–º–æ –∞–∫–æ –∏–º–∞ –Ω–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
  timestamp: "2024-12-16T10:00:00Z"
}
```

---

## üé® –ê–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞ final_plan

### –ù–æ–≤–∞ —Å–µ–∫—Ü–∏—è: `adaptedGuidance`

```json
{
  "adaptedGuidance": {
    "personalityType": "X-S-D-P",
    "communicationStyle": {
      "tone": "direct_concise",
      "complexity": "simple",
      "encouragementType": "action_focused"
    },
    "mealStructureAdaptations": {
      "flexibility": "low",
      "planningDetail": "high",
      "varietyLevel": "low"
    },
    "psychologicalSupport": {
      "primaryFocus": "habit_formation",
      "riskAreas": ["meal_skipping", "late_eating"]
    }
  }
}
```

### –ü—Ä–æ–º—è–Ω–∞ –Ω–∞ `psychologicalGuidance`

**–ü—Ä–µ–¥–∏** (generic):
```json
["–ü–æ—Å—Ç–∞–≤–µ—Ç–µ —Å–∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∏ —Ü–µ–ª–∏", "–ë—ä–¥–µ—Ç–µ —Ç—ä—Ä–ø–µ–ª–∏–≤–∏"]
```

**–°–ª–µ–¥** (–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –∑–∞ X-S-D-P):
```json
{
  "type": "X-S-D-P",
  "mainMessage": "–§–æ–∫—É—Å–∏—Ä–∞–π —Å–µ –Ω–∞ –ø—Ä–æ—Å—Ç–∞ —Ä—É—Ç–∏–Ω–∞.",
  "keyPrinciples": [
    "–°—ä–∑–¥–∞–π 2-3 —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∏ –º–æ–º–µ–Ω—Ç–∞",
    "–ü–æ–≤—Ç–∞—Ä—è—â–∏ —Å–µ —Ö—Ä–∞–Ω–∏",
    "–ë–µ–∑ —Å–ª–æ–∂–Ω–∏ —Ä–µ—Ü–µ–ø—Ç–∏"
  ]
}
```

---

## üí¨ –ö–æ–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω–∏ –ø—Ä–∏–º–µ—Ä–∏

### X-S-D-P (–î–∏—Ä–µ–∫—Ç–µ–Ω, –∫—Ä–∞—Ç—ä–∫)
> "–ó–∞–±–µ–ª—è–∑–∞—Ö, —á–µ –Ω–µ —Å–∏ –ª–æ–≥–Ω–∞–ª 2 –¥–Ω–∏. –õ–æ–≥–Ω–∏ —Å–µ–≥–∞."

### X-V-M-P (–ü–æ–¥–∫—Ä–µ–ø—è—â, –º–µ–∫)
> "–ó–¥—Ä–∞–≤–µ–π üëã –í–∏–∂–¥–∞–º, —á–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ –¥–Ω–∏ —Å–∞ –±–∏–ª–∏ –Ω–∞—Ç–æ–≤–∞—Ä–µ–Ω–∏. –ö–∞–∫ —Å–µ —á—É–≤—Å—Ç–≤–∞—à?"

### E-S-D-P (–ï–Ω–µ—Ä–≥–∏—á–µ–Ω, action-focused)
> "–•–µ–π! üí™ –ï–ª–∞ –¥–∞ –ø–æ–ø—ä–ª–Ω–∏–º –±—ä—Ä–∑–æ - 5 –º–∏–Ω—É—Ç–∏ –∏ —Å–º–µ –≥–æ—Ç–æ–≤–∏!"

### E-V-M-P (–ï–º–ø–∞—Ç–∏—á–µ–Ω, –µ–º–æ—Ü–∏–æ–Ω–∞–ª–µ–Ω)
> "–†–∞–∑–±–∏—Ä–∞–º, —á–µ –ø–æ–Ω—è–∫–æ–≥–∞ –µ —Ç—Ä—É–¥–Ω–æ. –ù–µ–∫–∞ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º –º–∞–ª–∫–∞ —Å—Ç—ä–ø–∫–∞ –∑–∞–µ–¥–Ω–æ üíô"

---

## üîß API Endpoints

### –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ composite profile
```javascript
POST /api/generateCompositeProfile
Body: { userId: "user123" }

Response: {
  success: true,
  data: {
    compositeProfile: {...},
    shouldRegeneratePlan: true
  }
}
```

### KV –∫–ª—é—á–æ–≤–µ
```
{userId}_composite_profile     // –û–±–µ–¥–∏–Ω–µ–Ω –ø—Ä–æ—Ñ–∏–ª
{userId}_correlation_history   // –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –∫–æ—Ä–µ–ª–∞—Ü–∏–∏
{userId}_psycho_regeneration_pending  // –§–ª–∞–≥ –∑–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ
```

---

## üìà –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è (—Ñ–∞–∑–∏)

### –§–∞–∑–∞ 1: –ö–æ—Ä–µ–ª–∞—Ü–∏–æ–Ω–µ–Ω –∞–Ω–∞–ª–∏–∑ (2-3 —Å–µ–¥–º–∏—Ü–∏)
- [ ] `calculateCorrelationScore()`
- [ ] `generateCompositeProfile()`
- [ ] Unit —Ç–µ—Å—Ç–æ–≤–µ

### –§–∞–∑–∞ 2: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –Ω–∞ final_plan (2-3 —Å–µ–¥–º–∏—Ü–∏)
- [ ] –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ `adaptedGuidance`
- [ ] –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ `psychologicalGuidance`
- [ ] Integration —Ç–µ—Å—Ç–æ–≤–µ

### –§–∞–∑–∞ 3: AI –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—è (2-3 —Å–µ–¥–º–∏—Ü–∏)
- [ ] Chat bot –∞–¥–∞–ø—Ç–∞—Ü–∏—è
- [ ] Notifications –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] A/B —Ç–µ—Å—Ç–≤–∞–Ω–µ

### –§–∞–∑–∞ 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (continuous)
- [ ] Analytics
- [ ] Feedback loop
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üöÄ Quick Start –∑–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏—Ü–∏

### 1. –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏
```javascript
const initialAnswers = await env.USER_METADATA_KV.get(`${userId}_initial_answers`, 'json');
const psychTests = await env.USER_METADATA_KV.get(`${userId}_psych_tests`, 'json');
```

### 2. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∫–æ—Ä–µ–ª–∞—Ü–∏—è
```javascript
const correlationScore = calculateCorrelationScore(
  initialAnswers, 
  psychTests.personalityTest
);
```

### 3. –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ composite profile
```javascript
const compositeProfile = await generateCompositeProfile(userId, env);
```

### 4. –ê–¥–∞–ø—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –ø–ª–∞–Ω
```javascript
const adaptedGuidance = generateAdaptedGuidance(compositeProfile);
finalPlan.adaptedGuidance = adaptedGuidance;
```

---

## üìö –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ —Ä–µ—Å—É—Ä—Å–∏

- **–ü—ä–ª–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [`PSYCHOMETRIC_PLAN_ADAPTATION_PROPOSAL_BG.md`](./PSYCHOMETRIC_PLAN_ADAPTATION_PROPOSAL_BG.md)
- **–ü—Å–∏—Ö–æ —Ç–µ—Å—Ç–æ–≤–µ**: [`psycho_tests_to_final_plan.md`](./psycho_tests_to_final_plan.md)
- **–ö–æ—Ä–µ–ª–∞—Ü–∏–æ–Ω–µ–Ω –∞–Ω–∞–ª–∏–∑**: [`QUESTIONNAIRE_ANALYSIS_CORRELATION.md`](./QUESTIONNAIRE_ANALYSIS_CORRELATION.md)
- **–ü–æ–¥–æ–±—Ä–µ–Ω–∏—è**: [`PSYCHO_TEST_IMPROVEMENTS.md`](./PSYCHO_TEST_IMPROVEMENTS.md)

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–î–∞—Ç–∞**: 2024-12-16  
**–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è**: –ü—Ä–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ –æ—Å–Ω–æ–≤–Ω–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
