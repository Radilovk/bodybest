<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Администраторски панел</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/base_styles.css">
  <link rel="stylesheet" href="css/layout_styles.css">
  <link rel="stylesheet" href="css/components_styles.css">
  <link rel="stylesheet" href="css/admin.css">
</head>
<body>
  <h1>Администраторски панел <span id="notificationIndicator" class="notification-dot hidden"></span></h1>
  <p><a href="logout.html">Изход</a></p>
  <section id="notificationsSection" class="card">
    <h2>Известия</h2>
    <ul id="notificationsList"></ul>
  </section>
  <div class="layout">
  <aside class="sidebar card" id="clientsSection">
    <h2>Клиенти</h2>
    <input id="clientSearch" placeholder="Търсене по име">
    <select id="statusFilter">
      <option value="all">Всички</option>
      <option value="pending">pending</option>
      <option value="processing">processing</option>
      <option value="ready">ready</option>
    </select>
    <select id="tagFilter">
      <option value="all">Всички етикети</option>
    </select>
    <select id="sortOrder">
      <option value="name">Сортирай по име</option>
      <option value="date">Сортирай по дата</option>
    </select>
    <p id="clientsCount"></p>
    <button id="showStats">Покажи статистика</button>
    <ul id="clientsList"></ul>
  </aside>

  <main id="clientDetails" class="main-content card hidden">
    <h2 id="clientName">Клиент</h2>
    <nav id="clientTabs" class="tabs styled-tabs" role="tablist">
      <button class="tab-btn" role="tab" aria-selected="true" data-target="profileTab">Профил</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-target="notesTab">Бележки</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-target="qaTab">Въпросник</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-target="menuTab">Меню</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-target="logsTab">Дневници</button>
      <button class="tab-btn" role="tab" aria-selected="false" data-target="dashboardTab">Данни</button>
    </nav>
    <section id="profileTab" class="client-tab active-tab-content" role="tabpanel">
    <details id="profileSection">
      <summary>Лични данни</summary>
      <form id="profileForm">
        <label>Име: <input id="profileName" type="text"></label><br>
        <label>Имейл: <input id="profileEmail" type="email"></label><br>
        <label>Телефон: <input id="profilePhone" type="tel"></label><br>
        <button type="submit">Запази профила</button>
      </form>
    </details>
    <button id="regeneratePlan">Генерирай нов план</button>
    <button id="aiSummary">AI резюме</button>
    </section>
    <section id="notesTab" class="client-tab" role="tabpanel" aria-hidden="true">
    <details id="notesSection">
      <summary>Бележки</summary>
      <textarea id="adminNotes" rows="3" cols="40"></textarea><br>
      <label>Етикети: <input id="adminTags"></label>
      <button id="saveNotes">Запази бележките</button>
    </details>
    </section>
    <section id="qaTab" class="client-tab" role="tabpanel" aria-hidden="true">
    <details id="qaSection">
      <summary>Данни от въпросника</summary>
      <div id="initialAnswers"></div>
    </details>
    </section>
    <section id="menuTab" class="client-tab" role="tabpanel" aria-hidden="true">
    <details id="menuSection">
      <summary>Текущо меню</summary>
      <div id="planMenu"></div>
    </details>
    </section>
    <section id="logsTab" class="client-tab" role="tabpanel" aria-hidden="true">
    <details id="logsSection">
      <summary>Дневници</summary>
      <div id="dailyLogs"></div>
    </details>
    </section>
    <section id="dashboardTab" class="client-tab" role="tabpanel" aria-hidden="true">
    <details id="dashboardSection">
      <summary>Пълни данни</summary>
      <div id="dashboardSummary"></div>
      <details>
        <summary>JSON</summary>
        <pre id="dashboardData" class="json"></pre>
      </details>
    </details>
    <button id="exportData">Експортирай всички данни</button>
    <button id="exportPlan">Експортирай плана като JSON</button>
    <button id="exportCsv">Експортирай дневниците CSV</button>
    </section>

    <details id="queriesSection">
      <summary>Запитвания <span id="queriesDot" class="notification-dot hidden"></span></summary>
      <ul id="queriesList"></ul>
      <textarea id="newQueryText" rows="3" cols="40"></textarea><br>
      <button id="sendQuery">Изпрати запитване</button>
    </details>
    <details id="clientRepliesSection">
      <summary>Отговори от клиента <span id="repliesDot" class="notification-dot hidden"></span></summary>
      <ul id="clientRepliesList"></ul>
    </details>
    <details id="feedbackSection">
      <summary>Обратна връзка <span id="feedbackDot" class="notification-dot hidden"></span></summary>
      <ul id="feedbackList"></ul>
    </details>
  </main>
  </div>

  <section id="statsSection" class="hidden">
    <h2>Статистика</h2>
    <pre id="statsOutput"></pre>
    <canvas id="statusChart" width="300" height="200"></canvas>
  </section>

  <details id="aiConfigSection" class="card">
    <summary>AI конфигурация</summary>
    <form id="aiConfigForm">
      <p class="note">Токените за моделите се задават като Worker secrets и не се
        редактират от този панел. Полето „Admin Token" се използва за
        удостоверяване на заявките към API.</p>
      <label>Admin Token: <input id="adminToken" type="text"></label>
      <fieldset>
        <legend>Генериране на план</legend>
        <label>Модел: <input id="planModel" type="text"> <button type="button" id="testPlanModel">Тествай</button></label>
      </fieldset>
      <fieldset>
        <legend>Чат</legend>
        <label>Модел: <input id="chatModel" type="text"> <button type="button" id="testChatModel">Тествай</button></label>
      </fieldset>
      <fieldset>
        <legend>Модификация на плана</legend>
        <label>Модел: <input id="modModel" type="text"> <button type="button" id="testModModel">Тествай</button></label>
      </fieldset>
      <div class="preset-controls">
        <label>Запазени настройки:
          <select id="aiPresetSelect"></select>
        </label>
        <button type="button" id="applyPreset">Зареди</button>
        <label>Ново име: <input id="presetName" type="text"></label>
        <button type="button" id="savePreset">Запази пресет</button>
      </div>
      <button type="submit">Запази</button>
    </form>
  </details>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script type="module" src="js/admin.js"></script>
</body>
</html>
